<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Write Something about your Day</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 600px;
    margin: auto;
    position: relative;
    background: url(https://i.pinimg.com/736x/2b/52/aa/2b52aab2cceb3da15c637e4dc2d0dfeb.jpg) no-repeat center center fixed;
    background-size: cover;
    overflow-x: hidden;
    color: #fff;
  }
  h2{
    color: #000;
  }
  p{ 
    color: #000;
  }
  h3{
    color: #000;
  }
  textarea {
  width: 95%;
  min-height: 60px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  background-color: #cfcec3(255, 255, 255, 0.395);
  color: #000;
  font-size: 16px;
  resize: none;
  overflow: hidden;
  box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}


  textarea:focus {
    outline: none;
    background-color: rgba(255,255,255,0.3);
    box-shadow: 0 0 10px rgba(0,255,200,0.5);
  }

  .entry {
    border: 1px solid rgba(0, 0, 0, 0.3);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 12px;
    background-color: rgba(0,0,0,0.4);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  }

  small {
    color: #ffd700;
  }

  button:not(#logoutBtn) {
    margin: 5px 5px 0 0;
    padding: 10px 20px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    font-size: 14px;
    transition: transform 0.2s, background-color 0.2s, color 0.2s;
    background: linear-gradient(135deg, #00ffe7, #00b8a9);
    color: #000;
    box-shadow: 0 4px 6px rgba(0,0,0,0.4);
  }

  button:not(#logoutBtn):hover {
    transform: scale(1.05);
    background: linear-gradient(135deg, #00b8a9, #43a1ff);
    color: #fff;
  }

  #logoutBtn {
    position: absolute;
    top: 50px;
    right: 20px;
    border-radius: 12px;
    background-color: red;
    color: white;
    padding: 15px 30px;
    font-size: 18px;
    font-weight: bold;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s, background-color 0.2s;
  }

  #logoutBtn:hover {
    background-color: darkred;
    transform: scale(1.05);
  }
</style>
</head>
<body>

<h2>Write Something about your Day</h2>
<p id="welcome"></p>

<button id="logoutBtn" onclick="logout()">Logout</button>

<h3>Add New Note</h3>
<textarea id="content" placeholder="Write your diary entry here..."></textarea><br>
<button onclick="addEntry()">Add Note</button>

<hr>

<h3>Your Notes</h3>
<div id="entries"></div>

<script>
const user = JSON.parse(localStorage.getItem('user'));
if (!user) window.location.href = 'login.html';
document.getElementById('welcome').innerText = `Welcome, ${user.name}!`;

const storageKey = `entries_${user.name}`;
let diaryEntries = JSON.parse(localStorage.getItem(storageKey)) || [];

function getDateTime() {
  const now = new Date();
  return now.toLocaleString('en-US', {
    year: 'numeric', month: 'short', day: 'numeric',
    hour: 'numeric', minute: '2-digit', hour12: true
  });
}

function renderEntries() {
  const container = document.getElementById('entries');
  container.innerHTML = '';

  diaryEntries.forEach((entry, index) => {
    container.innerHTML += `
      <div class="entry">
        <small>${entry.datetime}</small><br>
        <textarea id="edit-${index}" disabled
          oninput="autoResize(this)">${entry.content}</textarea><br>
        <button onclick="enableEdit(${index})">Edit</button>
        <button onclick="saveEdit(${index})" hidden id="save-${index}">Save</button>
        <button onclick="deleteEntry(${index})">Delete</button>
      </div>
    `;
  });
  document.querySelectorAll('.entry textarea').forEach(t => autoResize(t));
}


function addEntry() {
  const content = document.getElementById('content').value.trim();
  if (!content) return alert('Write something first');
  diaryEntries.unshift({ content, datetime: getDateTime() });
  localStorage.setItem(storageKey, JSON.stringify(diaryEntries));
  document.getElementById('content').value = '';
  renderEntries();
}

function enableEdit(index) {
  document.getElementById(`edit-${index}`).disabled = false;
  document.getElementById(`save-${index}`).hidden = false;
}

function saveEdit(index) {
  const updated = document.getElementById(`edit-${index}`).value.trim();
  if (!updated) return alert('Entry cannot be empty');
  diaryEntries[index].content = updated;
  localStorage.setItem(storageKey, JSON.stringify(diaryEntries));
  renderEntries();
}

function deleteEntry(index) {
  if (!confirm('Are you sure you want to delete this entry?')) return;
  diaryEntries.splice(index, 1);
  localStorage.setItem(storageKey, JSON.stringify(diaryEntries));
  renderEntries();
}

function logout() {
  localStorage.removeItem('user');
  window.location.href = 'register.html';
}

renderEntries();
function autoResize(textarea) {
  textarea.style.height = "auto";
  textarea.style.height = textarea.scrollHeight + "px";
}

</script>

</body>
</html>
