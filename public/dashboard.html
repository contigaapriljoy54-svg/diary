<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diary Dashboard</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background: url(https://betterlyf-upload.s3.amazonaws.com/1672910170319.jpg) no-repeat center center fixed;
  background-size: cover;
  color: white;
}

body::before {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: -1;
}

header {
  display: flex;
  justify-content: flex-start;
  padding: 20px;
}

#logout {
  background: #e74c3c;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

#logout:hover {
  background: #c0392b;
}

.container {
  max-width: 800px;
  margin: 20px auto;
  background: rgba(0,0,0,0.6);
  padding: 30px;
  border-radius: 15px;
}

h2 {
  text-align: center;
  margin-bottom: 25px;
}

textarea {
  width: 100%;
  padding: 15px;
  border-radius: 10px;
  border: none;
  resize: none;
  font-size: 15px;
  outline: none;
}

#addNote {
  margin-top: 15px;
  padding: 12px;
  width: 100%;
  border-radius: 8px;
  border: none;
  background: #27ae60;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

#addNote:hover {
  background: #1e8449;
}

.note {
  background: rgba(255,255,255,0.1);
  padding: 15px;
  margin-top: 20px;
  border-radius: 10px;
  white-space: pre-wrap;
}

.note textarea {
  background: rgba(255,255,255,0.2);
  color: white;
  margin-bottom: 10px;
}

.buttons {
  margin-top: 10px;
}

button.small {
  padding: 6px 12px;
  margin-right: 8px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.edit { background: #2980b9; color: white; }
.update { background: #27ae60; color: white; }
.delete { background: #e74c3c; color: white; }

button.small:hover {
  opacity: 0.85;
}
</style>
</head>

<body>

<header>
  <button id="logout">Logout</button>
</header>

<div class="container">
  <h2>Write something about your day</h2>

  <textarea id="newNote" rows="4" placeholder="Write your thoughts..."></textarea>
  <button id="addNote">Add Note</button>

  <div id="notesContainer"></div>
</div>

<script>
const user = JSON.parse(localStorage.getItem('user'));
if (!user) window.location.href = 'login.html';

const logoutBtn = document.getElementById('logout');
const addNoteBtn = document.getElementById('addNote');
const newNoteInput = document.getElementById('newNote');
const notesContainer = document.getElementById('notesContainer');

let notes = JSON.parse(localStorage.getItem(user.email + "_notes")) || [];

logoutBtn.onclick = () => {
  localStorage.removeItem('user');
  window.location.href = 'login.html';
};

function saveNotes() {
  localStorage.setItem(user.email + "_notes", JSON.stringify(notes));
}

function renderNotes() {
  notesContainer.innerHTML = "";

  notes.forEach((noteText, index) => {
    const noteDiv = document.createElement('div');
    noteDiv.className = "note";

    const content = document.createElement('div');
    content.innerText = noteText;

    const editArea = document.createElement('textarea');
    editArea.value = noteText;
    editArea.style.display = "none";

    const btnDiv = document.createElement('div');
    btnDiv.className = "buttons";

    const editBtn = document.createElement('button');
    editBtn.innerText = "Edit";
    editBtn.className = "small edit";

    const updateBtn = document.createElement('button');
    updateBtn.innerText = "Update";
    updateBtn.className = "small update";
    updateBtn.style.display = "none";

    const deleteBtn = document.createElement('button');
    deleteBtn.innerText = "Delete";
    deleteBtn.className = "small delete";

    editBtn.onclick = () => {
      content.style.display = "none";
      editArea.style.display = "block";
      editBtn.style.display = "none";
      updateBtn.style.display = "inline-block";
    };

    updateBtn.onclick = () => {
      notes[index] = editArea.value;
      saveNotes();
      renderNotes();
    };

    deleteBtn.onclick = () => {
      notes.splice(index, 1);
      saveNotes();
      renderNotes();
    };

    btnDiv.appendChild(editBtn);
    btnDiv.appendChild(updateBtn);
    btnDiv.appendChild(deleteBtn);

    noteDiv.appendChild(content);
    noteDiv.appendChild(editArea);
    noteDiv.appendChild(btnDiv);

    notesContainer.appendChild(noteDiv);
  });
}

addNoteBtn.onclick = () => {
  const text = newNoteInput.value.trim();
  if (!text) return;

  notes.push(text);
  saveNotes();
  newNoteInput.value = "";
  renderNotes();
};

renderNotes();
</script>

</body>
</html>
